{
    "version": "https://jsonfeed.org/version/1",
    "title": "Phoenix • All posts by \"report_export\" tag",
    "description": "Every day is a chance to learn something new",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2025/12/30/%E6%97%A5%E6%8A%A5%E5%AF%BC%E5%87%BA%E6%80%9D%E8%B7%AF/",
            "url": "http://example.com/2025/12/30/%E6%97%A5%E6%8A%A5%E5%AF%BC%E5%87%BA%E6%80%9D%E8%B7%AF/",
            "title": "日报导出思路",
            "date_published": "2025-12-30T07:32:10.000Z",
            "content_html": "<p>背景：数据报表导出这个功能，是很多 B 端产品都需要具备的功能，那么如何进行导出，出现异常如何处理是我们需要解决的问题，我把一个实习中做的思路讲解一下</p>\n<p>工作时的背景： 只要求完成基础功能 + 能有一定的兜底方案 + 不复杂的架构</p>\n<p>需求：把每日的 top10 拥堵路段、流量分析、交通违法情况进行统计，并发往指定 level 的用户（权限划分）</p>\n<p>采取的方案是：只使用 Spring 的 @schedule 进行轻量级定时任务，相比于 XXL-job 和 Quartz 这种需要维护而且成本高的架构，一个简单的日报导出是不需要那么复杂的，因为日报他首先数据量不大，有很大的容错空间，并不会导致一连串的下游任务或者数据错误，使用 xxl-job 的场景，这个是一个可以进行分布式调度的工作调度机器，常用于任务比较重要的，比如数据库的定时迁移等等，所以相比之下，一个普通的日报，只需要发送给指定的用户，如果为了炫技而使用 xxl-job\\quartz 这种，反而增加了成本。使用 @Schedule 每日凌晨进行数据导出任务，对违法信息表、交通流量表、设备情况表等数据表进行数据查询操作，并结合 Ai 对数据进行分析，形成一份带有数据 + 总结的日报。形成日报后，指定日报的等级，并推送到指定 level 用户的系统邮箱中，并保存到本地（用于提供给用户下载途经），那么如果没出错的话，这个功能就完成了，但是也会有异常情况，比如数据源未准备完成、数据库访问异常、报表生成失败、邮件通道不可用、定时调度异常以及业务规则变更等，所以得有一定的兜底方案，当时是做了一个生成异常就告警运维人员的通知，并且留了一个手动补跑的接口提供给运维人员进行，当运维人员发现错误后，需要解决问题或者通知开发人员解决，解决后再手动执行该次日报导出功能，也就是手动补跑。大概方案就是这样，由于是小公司，而且求稳 + 简单 + 用户不感知，所以采取了这样的一个方案。</p>\n<p>模拟的代码可以看：<a href=\"https://github.com/HuanchaoFeng/reportDemo\">https://github.com/HuanchaoFeng/reportDemo</a></p>\n",
            "tags": [
                "report_export"
            ]
        }
    ]
}